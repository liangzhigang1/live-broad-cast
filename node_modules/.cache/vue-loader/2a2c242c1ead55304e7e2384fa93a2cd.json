{"remainingRequest":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/ModalPanel/RollCallTeacher.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/ModalPanel/RollCallTeacher.vue","mtime":1611227050000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBsYW5ndWFnZSBmcm9tICIuLi8uLi9sYW5ndWFnZS9tYWluIjsKCmNvbnN0IGF1dGggPSBCSlkuYXV0aDsKY29uc3QgZXZlbnRFbWl0dGVyID0gQkpZLmV2ZW50RW1pdHRlcjsKCmNvbnN0IFJPTExfQ0FMTF9TVEFUVVMgPSB7CiAgICBiZWZvcmU6IDAsCiAgICBpbmc6IDEsCiAgICBhZnRlcjogMgp9CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxhbmd1YWdlOiBsYW5ndWFnZSwKICAgICAgc3RhdHVzOiAwLAogICAgICBpc1RlYWNoZXI6IGF1dGguaXNUZWFjaGVyKCksCiAgICAgIHJlc3VsdFRpbWVyOiA2MCwKICAgICAgbmV4dFRpbWVyOiA2MCwKICAgICAgcmVzdWx0OiAiIiwKICAgICAgcm9sbENhbGxEdXJhdGlvbjogNjAsCiAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICBzdGF0dXM6IFJPTExfQ0FMTF9TVEFUVVMuYmVmb3JlLAogICAgICBzdGF0dXNNYXA6IFJPTExfQ0FMTF9TVEFUVVMsCiAgICAgIHJlc3VsdEludGVydmFsOiBudWxsLAogICAgICBhY2tDb3VudDogMCwgLy8g562U5Yiw5Lq65pWwCiAgICAgIG5hY2tDb3VudDogMCwgLy8g5pyq562U5Yiw5Lq65pWwCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGV2ZW50RW1pdHRlcgogICAgICAub24oInRvZ2dsZV9yb2xsX2NhbGwiLCAoKSA9PiB7CiAgICAgICAgdGhpcy5zaG93KCk7CiAgICAgIH0pCiAgICAgIC5vbigKICAgICAgICAvLyDngrnlkI3nu5PmnpwKICAgICAgICBldmVudEVtaXR0ZXIuUk9MTF9DQUxMX1JFU1VMVCwKICAgICAgICAoZSwgZGF0YSkgPT4gewogICAgICAgICAgdmFyIHJlc3VsdCA9IGRhdGE7CiAgICAgICAgLy8gIOeCueWQjee7k+aenCAKICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7CiAgICAgICAgICB0aGlzLnN0YXR1cyA9IFJPTExfQ0FMTF9TVEFUVVMuYWZ0ZXIKCiAgICAgICAgICB0aGlzLmFja0NvdW50ID0gcmVzdWx0LmFja0xpc3QubGVuZ3RoCiAgICAgICAgICB0aGlzLm5hY2tDb3VudCA9IHJlc3VsdC5uYWNrTGlzdC5sZW5ndGgKICAgICAgICB9CiAgICAgICkKICAgICAgLm9uKAogICAgICAgIC8vIOeCueWQjeW8gOWniwogICAgICAgIGV2ZW50RW1pdHRlci5ST0xMX0NBTEwsCiAgICAgICAgKCkgPT4gewogICAgICAgICAgICB0aGlzLnJlc3VsdFRpbWVyID0gdGhpcy5yb2xsQ2FsbER1cmF0aW9uCiAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gUk9MTF9DQUxMX1NUQVRVUy5pbmcKICAgICAgICAgICAgdGhpcy5yZXN1bHRJbnRlcnZhbCA9IG51bGwKICAgICAgICAgICAgdGhpcy5yZXN1bHRJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdFRpbWVyID4gMCkgewogICAgICAgICAgICAgICAgICAgIC0tdGhpcy5yZXN1bHRUaW1lcjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8g5pe26Ze05Yiw5LqG6ZyA6KaB6ICB5biI56uv5Li75Yqo6Kem5Y+R57uT5p2fCiAgICAgICAgICAgICAgICAgICAgZXZlbnRFbWl0dGVyLnRyaWdnZXIoZXZlbnRFbWl0dGVyLlJPTExfQ0FMTF9GSU5JU0gpOwogICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5yZXN1bHRJbnRlcnZhbCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgfQogICAgICApOwogIH0sCiAgbWV0aG9kczogewogICAgc2hvdygpIHsKICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICBjbG9zZSgpIHsKICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7CiAgICB9LAogICAgc3RhcnRSb2xsQ2FsbCgpIHsKICAgICAgZXZlbnRFbWl0dGVyLnRyaWdnZXIoZXZlbnRFbWl0dGVyLlJPTExfQ0FMTF9UUklHR0VSLCB7CiAgICAgICAgLy8g5YCS6K6h5pe2IOenkgogICAgICAgIGR1cmF0aW9uOiB0aGlzLnJvbGxDYWxsRHVyYXRpb24sCiAgICAgIH0pOwogICAgfSwKICAgIHJlQ2FsbCgpIHsKICAgICAgICB0aGlzLnN0YXR1cyA9IFJPTExfQ0FMTF9TVEFUVVMuYmVmb3JlCiAgICB9CiAgfSwKICBiZWZvcmVEZXN0cm95KCkge30sCn07Cg=="},{"version":3,"sources":["RollCallTeacher.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RollCallTeacher.vue","sourceRoot":"src/components/ModalPanel","sourcesContent":["<!-- 点名组件实现： 点名没有独立的组件来实现，我们提供了一套事件驱动的点名系统 -->\n\n<template>\n  <div v-show=\"visible\" id=\"roll-call-dialog\" class=\"teacher\">\n    <div v-show=\"status === statusMap.before\" class=\"before-roll-call\">\n      <p>\n        请设置学生需要在\n        <input v-model=\"rollCallDuration\" type=\"number\" />\n        秒内响应\n      </p>\n      <div @click=\"startRollCall\" class=\"btn start-btn\">发起点名</div>\n    </div>\n\n    <div v-show=\"status === statusMap.ing\" class=\"roll-call-ing\">学生正在陆续答到中，{{ resultTimer }}秒后可查看点名结果，请稍后</div>\n\n    <div v-show=\"status === statusMap.after\" class=\"after-roll-call\">\n      <p class=\"result\">答到情况：答到{{ ackCount }}人，未答到{{ nackCount }}人</p>\n      <div class=\"btn\" @click=\"reCall\">再次点名</div>\n    </div>\n\n    <div class=\"btn-close\" @click=\"close\">X</div>\n  </div>\n</template>\n\n<script>\nimport language from \"../../language/main\";\n\nconst auth = BJY.auth;\nconst eventEmitter = BJY.eventEmitter;\n\nconst ROLL_CALL_STATUS = {\n    before: 0,\n    ing: 1,\n    after: 2\n}\n\nexport default {\n  data() {\n    return {\n      language: language,\n      status: 0,\n      isTeacher: auth.isTeacher(),\n      resultTimer: 60,\n      nextTimer: 60,\n      result: \"\",\n      rollCallDuration: 60,\n      visible: false,\n      status: ROLL_CALL_STATUS.before,\n      statusMap: ROLL_CALL_STATUS,\n      resultInterval: null,\n      ackCount: 0, // 答到人数\n      nackCount: 0, // 未答到人数\n    };\n  },\n  created() {\n    eventEmitter\n      .on(\"toggle_roll_call\", () => {\n        this.show();\n      })\n      .on(\n        // 点名结果\n        eventEmitter.ROLL_CALL_RESULT,\n        (e, data) => {\n          var result = data;\n        //  点名结果 \n          console.log(result);\n          this.status = ROLL_CALL_STATUS.after\n\n          this.ackCount = result.ackList.length\n          this.nackCount = result.nackList.length\n        }\n      )\n      .on(\n        // 点名开始\n        eventEmitter.ROLL_CALL,\n        () => {\n            this.resultTimer = this.rollCallDuration\n            this.status = ROLL_CALL_STATUS.ing\n            this.resultInterval = null\n            this.resultInterval = setInterval(() => {\n                if (this.resultTimer > 0) {\n                    --this.resultTimer;\n                } else {\n                    // 时间到了需要老师端主动触发结束\n                    eventEmitter.trigger(eventEmitter.ROLL_CALL_FINISH);\n                    clearInterval(this.resultInterval)\n                }\n            }, 1000);\n        }\n      );\n  },\n  methods: {\n    show() {\n      this.visible = true;\n    },\n    close() {\n      this.visible = false;\n    },\n    startRollCall() {\n      eventEmitter.trigger(eventEmitter.ROLL_CALL_TRIGGER, {\n        // 倒计时 秒\n        duration: this.rollCallDuration,\n      });\n    },\n    reCall() {\n        this.status = ROLL_CALL_STATUS.before\n    }\n  },\n  beforeDestroy() {},\n};\n</script>\n\n<style lang=\"scss\" scoped>\n#roll-call-dialog {\n  background: #fff;\n  padding: 24px;\n  font-size: 14px;\n\n  & > div {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .btn-close {\n    position: absolute;\n    top: 10px;\n    right: 10px;\n    cursor: pointer;\n  }\n\n  .before-roll-call {\n  }\n\n  .roll-call-ing {\n  }\n\n  .after-roll-call {\n  }\n\n  .btn {\n    margin: 20px auto;\n    background: #1795ff;\n    height: 40px;\n    line-height: 40px;\n    padding: 0 20px;\n    cursor: pointer;\n    color: #fff;\n  }\n}\n</style>\n"]}]}