{"remainingRequest":"/Users/liangzg/zixue/live-broad-cast/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzg/zixue/live-broad-cast/src/components/FunctionPanel/ShareScreenMenu.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzg/zixue/live-broad-cast/src/components/FunctionPanel/ShareScreenMenu.vue","mtime":1611227050000},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/cache-loader/dist/cjs.js","mtime":1584009001591},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/babel-loader/lib/index.js","mtime":1615566678361},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/cache-loader/dist/cjs.js","mtime":1584009001591},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/vue-loader/lib/index.js","mtime":1615566687412}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBsYW5ndWFnZSBmcm9tICcuLi8uLi9sYW5ndWFnZS9tYWluJwoKbGV0IGF1dGggPSBCSlkuYXV0aApsZXQgc3RvcmUgPSBCSlkuc3RvcmUKbGV0IGV2ZW50RW1pdHRlciA9IEJKWS5ldmVudEVtaXR0ZXIKbGV0IGNvbmZpZyA9IEJKWS5jb25maWcKCmF1dGguaXNDbGFzc1N0YXJ0ZWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHN0b3JlLmdldCgnY2xhc3Muc3RhcnRlZCcpCn0KCmF1dGguY2FuU2hhcmVTY3JlZW4gPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHN0b3JlLmdldCgnY2xhc3MubWVkaWFUeXBlJykgIT09IGNvbmZpZy5NRURJQV9UWVBFX0FVRElPICYmCiAgICAgICAgICAgIChhdXRoLmluQ2xpZW50KCkgfHwgYXV0aC5pc1dlYlJUQygpKQp9CgphdXRoLmluQ2xpZW50ID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB0eXBlb2Ygd2luZG93LmNlZlF1ZXJ5ICE9PSAndW5kZWZpbmVkJwp9CgphdXRoLmNhblNwZWFrID0gZnVuY3Rpb24gKCkgewogIHJldHVybiBhdXRoLmlzVGVhY2hlcigpIHx8IChzdG9yZS5nZXQoJ2NsYXNzLnNwZWFrU3RhdGUnKSAhPT0gY29uZmlnLlNQRUFLX1NUQVRFX0xJTUlUKQp9CgovKioKICog5piv5ZCm5Y+v5Lul56iL5bqP5YiG5LqrCiAqCiAqIEByZXR1cm4ge2Jvb2xlYW59CiAqLwphdXRoLmNhblByb2dyYW1TaGFyZURlc2t0b3AgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGF1dGguaW5DbGllbnQoKSAmJiBzdG9yZS5nZXQoJ2NlZlZlcnNpb24nKSA+PSAnNi4zLjAnCn0KCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7fSwKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIGNhblNwZWFrOiBmYWxzZSwKICAgICAgY2FuU2hhcmVTY3JlZW46IGF1dGguY2FuU2hhcmVTY3JlZW4oKQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHt9LAogIHdhdGNoOiB7fSwKICBtZXRob2RzOiB7CiAgICBjaGVja0NvbmRpdGlvbiAoKSB7CiAgICAgIGlmICghYXV0aC5pc0NsYXNzU3RhcnRlZCgpIHx8ICFhdXRoLmNhblNoYXJlU2NyZWVuKCkpIHsKICAgICAgICB0aGlzLiRUb2FzdChsYW5ndWFnZS5USVBfQ0xBU1NfTk9UX1NUQVJUKQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CgogICAgICBpZiAoIWF1dGguY2FuU3BlYWsoKSkgewogICAgICAgIHRoaXMuJFRvYXN0KGxhbmd1YWdlLlRJUF9TUEVBS19MSU1JVCkKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWUKICAgIH0KICB9LAogIG1vdW50ZWQgKCkgewogICAgbGV0IGVsZW1lbnQgPSAkKCcuYmp5LXNjcmVlbi1zaGFyZScpCiAgICAvLyDlj6rmnIl3ZWJydGPor77nqIvnsbvlnovmlK/mjIHnvZHpobXlsY/luZXliIbkuqsKICAgIGVsZW1lbnQudGV4dChsYW5ndWFnZS5CVVRUT05fU0NSRUVOX1NUQVJUKQogICAgaWYgKGF1dGguaXNXZWJSVEMoKSkgewogICAgICB2YXIgaXNTY3JlZW5TaGFyaW5nID0gZmFsc2UKCiAgICAgIGV2ZW50RW1pdHRlci5vbigKICAgICAgICBldmVudEVtaXR0ZXIuQVNTSVNUX01FRElBX1BVQkxJU0gsCiAgICAgICAgKGV2ZW50LCBkYXRhKSA9PiB7CiAgICAgICAgICBpZiAoQkpZLmlzLm1lZGlhTWFpblNjcmVlblNoYXJlKGRhdGEubWVkaWFJZCkpIHsKICAgICAgICAgICAgaWYgKGRhdGEudmlkZW9PbikgewogICAgICAgICAgICAgIGlzU2NyZWVuU2hhcmluZyA9IHRydWUKICAgICAgICAgICAgICBlbGVtZW50LnRleHQobGFuZ3VhZ2UuQlVUVE9OX1NDUkVFTl9TVE9QKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlzU2NyZWVuU2hhcmluZyA9IGZhbHNlCiAgICAgICAgICAgICAgZWxlbWVudC50ZXh0KGxhbmd1YWdlLkJVVFRPTl9TQ1JFRU5fU1RBUlQpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICkKCiAgICAgIGVsZW1lbnQuY2xpY2soKCkgPT4gewogICAgICAgIGlmIChpc1NjcmVlblNoYXJpbmcpIHsKICAgICAgICAgIGV2ZW50RW1pdHRlci50cmlnZ2VyKAogICAgICAgICAgICBldmVudEVtaXR0ZXIuU0NSRUVOX1NIQVJFX1NUT1BfVFJJR0dFUgogICAgICAgICAgKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoIWF1dGguY2FuU3BlYWsoKSkgewogICAgICAgICAgICB0aGlzLiRUb2FzdCgn5Y+R6KiA6K+35YWI5Li+5omLJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmNoZWNrQ29uZGl0aW9uKCkgJiYgQkpZLlNjcmVlblNoYXJlRXh0ZW5zaW9uV2VicnRjLnN0YXJ0KChkYXRhKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJFRvYXN0KGRhdGEubXNnKQogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCiAgICB9CiAgfSwKICBiZWZvcmVEZXN0cm95ICgpIHt9Cn0K"},{"version":3,"sources":["ShareScreenMenu.vue"],"names":[],"mappings":";;;;;;;;AAQA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ShareScreenMenu.vue","sourceRoot":"src/components/FunctionPanel","sourcesContent":["<template>\n    <div v-show=\"canShareScreen\" id=\"menu-share-screen\">\n      <i class=\"icon icon-share\"></i>\n      <span class=\"bjy-screen-share\"></span>\n    </div>\n</template>\n\n<script>\nimport language from '../../language/main'\n\nlet auth = BJY.auth\nlet store = BJY.store\nlet eventEmitter = BJY.eventEmitter\nlet config = BJY.config\n\nauth.isClassStarted = function () {\n  return store.get('class.started')\n}\n\nauth.canShareScreen = function () {\n  return store.get('class.mediaType') !== config.MEDIA_TYPE_AUDIO &&\n            (auth.inClient() || auth.isWebRTC())\n}\n\nauth.inClient = function () {\n  return typeof window.cefQuery !== 'undefined'\n}\n\nauth.canSpeak = function () {\n  return auth.isTeacher() || (store.get('class.speakState') !== config.SPEAK_STATE_LIMIT)\n}\n\n/**\n * 是否可以程序分享\n *\n * @return {boolean}\n */\nauth.canProgramShareDesktop = function () {\n  return auth.inClient() && store.get('cefVersion') >= '6.3.0'\n}\n\nexport default {\n  components: {},\n  data () {\n    return {\n      canSpeak: false,\n      canShareScreen: auth.canShareScreen()\n    }\n  },\n  computed: {},\n  watch: {},\n  methods: {\n    checkCondition () {\n      if (!auth.isClassStarted() || !auth.canShareScreen()) {\n        this.$Toast(language.TIP_CLASS_NOT_START)\n        return false\n      }\n\n      if (!auth.canSpeak()) {\n        this.$Toast(language.TIP_SPEAK_LIMIT)\n        return false\n      }\n\n      return true\n    }\n  },\n  mounted () {\n    let element = $('.bjy-screen-share')\n    // 只有webrtc课程类型支持网页屏幕分享\n    element.text(language.BUTTON_SCREEN_START)\n    if (auth.isWebRTC()) {\n      var isScreenSharing = false\n\n      eventEmitter.on(\n        eventEmitter.ASSIST_MEDIA_PUBLISH,\n        (event, data) => {\n          if (BJY.is.mediaMainScreenShare(data.mediaId)) {\n            if (data.videoOn) {\n              isScreenSharing = true\n              element.text(language.BUTTON_SCREEN_STOP)\n            } else {\n              isScreenSharing = false\n              element.text(language.BUTTON_SCREEN_START)\n            }\n          }\n        }\n      )\n\n      element.click(() => {\n        if (isScreenSharing) {\n          eventEmitter.trigger(\n            eventEmitter.SCREEN_SHARE_STOP_TRIGGER\n          )\n        } else {\n          if (!auth.canSpeak()) {\n            this.$Toast('发言请先举手')\n            return\n          }\n          this.checkCondition() && BJY.ScreenShareExtensionWebrtc.start((data) => {\n            this.$Toast(data.msg)\n          })\n        }\n      })\n    }\n  },\n  beforeDestroy () {}\n}\n</script>\n\n<style lang='scss' scoped>\n//@import url(); 引入公共css类\n\n</style>\n"]}]}