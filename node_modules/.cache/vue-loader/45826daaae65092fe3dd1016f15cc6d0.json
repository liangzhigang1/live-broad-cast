{"remainingRequest":"/Users/liangzg/zixue/live-broad-cast/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzg/zixue/live-broad-cast/src/components/InteractionPanel/UserList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzg/zixue/live-broad-cast/src/components/InteractionPanel/UserList.vue","mtime":1611227050000},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/cache-loader/dist/cjs.js","mtime":1584009001591},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/babel-loader/lib/index.js","mtime":1615566678361},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/cache-loader/dist/cjs.js","mtime":1584009001591},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/vue-loader/lib/index.js","mtime":1615566687412}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KCmltcG9ydCB1c2VyUm9sZU1hcCBmcm9tICIuL2NvbW1vbi9yb2xlTWFwIjsKbGV0IGF1dGggPSBCSlkuYXV0aDsKbGV0IGNvbmZpZyA9IEJKWS5jb25maWc7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czoge30sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXJMYXllckluc3RhbmNlOiBudWxsLAogICAgICBsYXN0VXNlcjogbnVsbCwKICAgIH07CiAgfSwKICBjb21wdXRlZDoge30sCiAgd2F0Y2g6IHt9LAogIG1ldGhvZHM6IHsKICAgIC8vIOeUn+aIkOa1ruWxggogICAgc2V0TGF5ZXIodXNlUGFyYW1ldGVyVXNlciwgZSkgewogICAgICBsZXQgZWxlID0gJCgiLmJqeS11c2VyLWxheWVyIik7CiAgICAgIGlmICghdGhpcy51c2VyTGF5ZXJJbnN0YW5jZSB8fCAodGhpcy51c2VyTGF5ZXJJbnN0YW5jZSAmJiAhZWxlWzBdKSkgewogICAgICAgIGlmICh0aGlzLnVzZXJMYXllckluc3RhbmNlICYmICFlbGVbMF0pIHsKICAgICAgICAgIHRoaXMudXNlckxheWVySW5zdGFuY2UuZGVzdHJveSgpOwogICAgICAgIH0KICAgICAgICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICQoIiNhcHAiKS5hcHBlbmQobm9kZSk7CiAgICAgICAgdGhpcy51c2VyTGF5ZXJJbnN0YW5jZSA9IEJKWS5Vc2VyTGF5ZXIuY3JlYXRlKHsKICAgICAgICAgIHVzZXI6IHRoaXMubGFzdFVzZXIsCiAgICAgICAgICBlbGVtZW50OiAkKG5vZGUpLAogICAgICAgICAgcmVuZGVyVXNlcjogZnVuY3Rpb24gKHVzZXIsIHdpZHRoLCBoZWlnaHQpIHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBpZDogdXNlci5pZCwKICAgICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsCiAgICAgICAgICAgICAgbnVtYmVyOiB1c2VyLm51bWJlciwKICAgICAgICAgICAgICAvLyDlpLTlg4/pnIDljovnvKkKICAgICAgICAgICAgICBhdmF0YXI6IEJKWS5jb21wcmVzc0ltYWdlKHsKICAgICAgICAgICAgICAgIHVybDogdXNlci5hdmF0YXIsCiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsCiAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCwKICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICBhdmF0YXIyeDogQkpZLmNvbXByZXNzSW1hZ2UoewogICAgICAgICAgICAgICAgdXJsOiB1c2VyLmF2YXRhciwKICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCAqIDIsCiAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCAqIDIsCiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgLy8g5qC55o2u55So5oi357G75Z6L77yM6YWN572u6KeS6Imy55qE6Iux5paH5ZKM5pys5Zyw6K+t6KiACiAgICAgICAgICAgICAgcm9sZTogdXNlclJvbGVNYXBbdXNlci50eXBlXS5lbiwKICAgICAgICAgICAgICBsb2NhbFJvbGU6IHVzZXJSb2xlTWFwW3VzZXIudHlwZV0uY24sCiAgICAgICAgICAgIH07CiAgICAgICAgICB9LAogICAgICAgICAgdXNlUGFyYW1ldGVyVXNlcjogdXNlUGFyYW1ldGVyVXNlciwKICAgICAgICAgIHNwZWFrSW52aXRlVGltZW91dDogMTAgKiAxMDAwLAogICAgICAgICAgc2V0TWVkaWFUaW1lb3V0OiAxMCAqIDEwMDAsCiAgICAgICAgICBoYXNTd2l0Y2hQYWludDogZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICAgICAgaWYgKGF1dGguaXNUZWFjaGVyKCkgfHwgYXV0aC5pc0Fzc2lzdGFudCgpKSB7CiAgICAgICAgICAgICAgaWYgKGF1dGguaXNTdHVkZW50KHVzZXIudHlwZSkpIHsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgdXNlci5lbmRUeXBlID09PSBjb25maWcuRU5EX1RZUEVfTU9CSUxFX0JST1dTRVIgfHwKICAgICAgICAgICAgICAgICAgdXNlci5lbmRUeXBlID09PSBjb25maWcuRU5EX1RZUEVfWElBT0NIRU5HWFUKICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyDlpKfnj63or77lrabnlJ/msqHmnInkuIrpuqblsLHkuI3opoHmnInmjojmnYPnlLvnrJTnmoTmjInpkq7kuoYKICAgICAgICAgICAgICAgIGlmICghdXNlci52aWRlb09uICYmICF1c2VyLmF1ZGlvT24pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0sCiAgICAgICAgICBoYXNTd2l0Y2hEb2N1bWVudENvbnRyb2w6IGZ1bmN0aW9uICh1c2VyKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0sCiAgICAgICAgICBvbktpY2tPdXRDb25maXJtOiBmdW5jdGlvbiAoZGVmZXJyZWQsIHVzZXIsIGNvbnRlbnQpIHsKICAgICAgICAgICAgICBpZiAod2luZG93LmNvbmZpcm0oJ+ehruWumuimgeWwhuivpeWtpueUn+i4ouWHuuaVmeWupOWQl++8nycpKSB7CiAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUodHJ1ZSkKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChmYWxzZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZDsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnVzZXJMYXllckluc3RhbmNlLnNldCgidXNlUGFyYW1ldGVyVXNlciIsIHVzZVBhcmFtZXRlclVzZXIpOwogICAgICAgIHRoaXMudXNlckxheWVySW5zdGFuY2Uuc2V0KCJ1c2VyIiwgdGhpcy5sYXN0VXNlcik7CiAgICAgIH0KICAgICAgJCgiLmJqeS11c2VyLWxheWVyIikuY3NzKHsKICAgICAgICB0b3A6IGUub3JpZ2luYWxFdmVudC5jbGllbnRZICsgMTAgKyAicHgiLAogICAgICAgIGxlZnQ6IGUub3JpZ2luYWxFdmVudC5jbGllbnRYIC0gMTUwICsgInB4IiwKICAgICAgfSk7CgogICAgICAkKCIuYmp5LXVzZXItbGF5ZXIiKS50b2dnbGUoKTsKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgbGV0IGV2ZW50RW1pdHRlciA9IEJKWS5ldmVudEVtaXR0ZXI7CiAgICAvLyDnm5HlkKzkurrmlbDlj5jljJYKICAgIGV2ZW50RW1pdHRlci5vbihldmVudEVtaXR0ZXIuVVNFUl9DT1VOVF9DSEFOR0UsIGZ1bmN0aW9uIChlLCBkYXRhKSB7CiAgICAgICQoIiN1c2VyLWNvdW50IikudGV4dCgiKCIgKyBkYXRhLnVzZXJDb3VudCArICIpIik7CiAgICB9KTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICBsZXQgZXZlbnRFbWl0dGVyID0gQkpZLmV2ZW50RW1pdHRlcjsKICAgIGxldCBtZSA9IHRoaXM7CgogICAgQkpZLlVzZXJMaXN0LmNyZWF0ZSh7CiAgICAgIGVsZW1lbnQ6ICQoIiN1c2VyLWxpc3QiKSwKICAgICAgcmVuZGVyVXNlcjogZnVuY3Rpb24gKHVzZXIsIHdpZHRoLCBoZWlnaHQpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaWQ6IHVzZXIuaWQsCiAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsCiAgICAgICAgICBudW1iZXI6IHVzZXIubnVtYmVyLAogICAgICAgICAgLy8g5aS05YOP6ZyA5Y6L57ypCiAgICAgICAgICBhdmF0YXI6IEJKWS5jb21wcmVzc0ltYWdlKHsKICAgICAgICAgICAgdXJsOiB1c2VyLmF2YXRhciwKICAgICAgICAgICAgd2lkdGg6IHdpZHRoLAogICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCwKICAgICAgICAgIH0pLAogICAgICAgICAgYXZhdGFyMng6IEJKWS5jb21wcmVzc0ltYWdlKHsKICAgICAgICAgICAgdXJsOiB1c2VyLmF2YXRhciwKICAgICAgICAgICAgd2lkdGg6IHdpZHRoICogMiwKICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQgKiAyLAogICAgICAgICAgfSksCiAgICAgICAgICAvLyDmoLnmja7nlKjmiLfnsbvlnovvvIzphY3nva7op5LoibLnmoToi7HmloflkozmnKzlnLDor63oqIAKICAgICAgICAgIHJvbGU6IHVzZXJSb2xlTWFwW3VzZXIudHlwZV0uZW4sCiAgICAgICAgICBsb2NhbFJvbGU6IHVzZXJSb2xlTWFwW3VzZXIudHlwZV0uY24sCiAgICAgICAgfTsKICAgICAgfSwKICAgIH0pOwoKICAgIC8vIOiAgeW4iOerr+WcqOeUqOaIt+WIl+ihqOeUn+aIkOaTjeS9nOa1ruWxggogICAgaWYgKEJKWS5hdXRoLmlzVGVhY2hlcigpKSB7CiAgICAgIC8vIOaYr+WQpuWFgeiuuOmCgOivt+S4ium6pgogICAgICBCSlkuYXV0aC5jYW5TcGVha0ludml0ZSA9IGZ1bmN0aW9uICh0YXJnZXQpIHsKICAgICAgICByZXR1cm4gQkpZLmF1dGguaXNUZWFjaGVyKCkgJiYgKHRhcmdldCA/ICF0YXJnZXQuZ3JvdXAgOiB0cnVlKTsKICAgICAgfTsKCiAgICAgIC8vIOaYr+WQpuWFgeiuuOW8uuWItuWPkeiogO+8iOS4jumCgOivt+WPkeiogOS6kuaWpe+8iQogICAgICBCSlkuYXV0aC5jYW5TcGVha0ZvcmNlID0gZnVuY3Rpb24gKHRhcmdldCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAvLyDnu4TlhoXnlKjmiLfkuI3lhYHorrjooqvlvLrliLblj5HoqIAKICAgICAgICByZXR1cm4gQkpZLmF1dGguaXNUZWFjaGVyKCkgJiYgKHRhcmdldCA/ICF0YXJnZXQuZ3JvdXAgOiB0cnVlKTsKICAgICAgfTsKICAgICAgJCgiLnVzZXItbGlzdCIpLmRlbGVnYXRlKCIuYmp5LXVzZXItaXRlbSIsICJjbGljayIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgbGV0IG51bWJlciA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0Lm51bWJlcjsKICAgICAgICBsZXQgdXNlciA9IEJKWS5kYXRhLnVzZXIuZmluZEJ5TnVtYmVyKG51bWJlcik7CiAgICAgICAgLy8gdXNlcuS4jeWtmOWcqOWIsOacjeWKoeWZqOiOt+WPlgogICAgICAgIGlmICghdXNlcikgewogICAgICAgICAgZXZlbnRFbWl0dGVyLm9uZShldmVudEVtaXR0ZXIuVVNFUl9TRUFSQ0hfUkVTLCBmdW5jdGlvbiAoZXZlbnQsIGRhdGEpIHsKICAgICAgICAgICAgaWYgKGRhdGEucmVzdWx0ICYmIGRhdGEucmVzdWx0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICB1c2VyID0gZGF0YS5yZXN1bHRbMF07CiAgICAgICAgICAgICAgQkpZLmRhdGEudXNlci5hZGQodXNlcik7CiAgICAgICAgICAgICAgbWUubGFzdFVzZXIgPSB1c2VyOwogICAgICAgICAgICAgIG1lLnNldExheWVyKGZhbHNlLCBlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBldmVudEVtaXR0ZXIudHJpZ2dlcihldmVudEVtaXR0ZXIuVVNFUl9TRUFSQ0hfUkVRLCB7CiAgICAgICAgICAgIHF1ZXJ5OiB1c2VyTnVtYmVyLAogICAgICAgICAgICBmaWVsZDogIm51bWJlciIsCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbWUubGFzdFVzZXIgPSB1c2VyOwogICAgICAgICAgbWUuc2V0TGF5ZXIoZmFsc2UsIGUpOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICAkKCIjYXBwIikuZGVsZWdhdGUoIi5ianktdXNlci1sYXllciIsICJjbGljayIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9KTsKCiAgICAgICQoIiNhcHAiKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgJCgiLmJqeS11c2VyLWxheWVyIikgJiYgJCgiLmJqeS11c2VyLWxheWVyIikuaGlkZSgpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIOWtpueUn+err+aOpeaUtumCgOivt+WPkeiogOS/oeS7pAogICAgICBsZXQgdXNlclNwZWFrID0gQkpZLnVzZXJTcGVhazsKICAgICAgZXZlbnRFbWl0dGVyLm9uKGV2ZW50RW1pdHRlci5TUEVBS19JTlZJVEVfQ09ORklSTSwgZnVuY3Rpb24gKCkgewogICAgICAgIGxldCByZXMgPSBjb25maXJtKCLogIHluIjpgoDor7fkvaDkuIrpuqblj5HoqIAiKTsKICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICB1c2VyU3BlYWsucHJvY2Vzc0ludml0ZSh0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdXNlclNwZWFrLnByb2Nlc3NJbnZpdGUoZmFsc2UpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBiZWZvcmVEZXN0cm95KCkge30sCn07Cg=="},{"version":3,"sources":["UserList.vue"],"names":[],"mappings":";;;;;AAKA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserList.vue","sourceRoot":"src/components/InteractionPanel","sourcesContent":["<template>\n  <div id=\"user-list\"></div>\n</template>\n\n<script>\nimport userRoleMap from \"./common/roleMap\";\nlet auth = BJY.auth;\nlet config = BJY.config;\n\nexport default {\n  components: {},\n  data() {\n    return {\n      userLayerInstance: null,\n      lastUser: null,\n    };\n  },\n  computed: {},\n  watch: {},\n  methods: {\n    // 生成浮层\n    setLayer(useParameterUser, e) {\n      let ele = $(\".bjy-user-layer\");\n      if (!this.userLayerInstance || (this.userLayerInstance && !ele[0])) {\n        if (this.userLayerInstance && !ele[0]) {\n          this.userLayerInstance.destroy();\n        }\n        let node = document.createElement(\"div\");\n        $(\"#app\").append(node);\n        this.userLayerInstance = BJY.UserLayer.create({\n          user: this.lastUser,\n          element: $(node),\n          renderUser: function (user, width, height) {\n            return {\n              id: user.id,\n              name: user.name,\n              number: user.number,\n              // 头像需压缩\n              avatar: BJY.compressImage({\n                url: user.avatar,\n                width: width,\n                height: height,\n              }),\n              avatar2x: BJY.compressImage({\n                url: user.avatar,\n                width: width * 2,\n                height: height * 2,\n              }),\n              // 根据用户类型，配置角色的英文和本地语言\n              role: userRoleMap[user.type].en,\n              localRole: userRoleMap[user.type].cn,\n            };\n          },\n          useParameterUser: useParameterUser,\n          speakInviteTimeout: 10 * 1000,\n          setMediaTimeout: 10 * 1000,\n          hasSwitchPaint: function (user) {\n            if (auth.isTeacher() || auth.isAssistant()) {\n              if (auth.isStudent(user.type)) {\n                if (\n                  user.endType === config.END_TYPE_MOBILE_BROWSER ||\n                  user.endType === config.END_TYPE_XIAOCHENGXU\n                ) {\n                  return false;\n                }\n                // 大班课学生没有上麦就不要有授权画笔的按钮了\n                if (!user.videoOn && !user.audioOn) {\n                  return false;\n                }\n                return true;\n              }\n            }\n            return false;\n          },\n          hasSwitchDocumentControl: function (user) {\n            return false;\n          },\n          onKickOutConfirm: function (deferred, user, content) {\n              if (window.confirm('确定要将该学生踢出教室吗？')) {\n                  deferred.resolve(true)\n                } else {\n                  deferred.reject(false)\n                }\n                return deferred;\n          }\n        });\n      } else {\n        this.userLayerInstance.set(\"useParameterUser\", useParameterUser);\n        this.userLayerInstance.set(\"user\", this.lastUser);\n      }\n      $(\".bjy-user-layer\").css({\n        top: e.originalEvent.clientY + 10 + \"px\",\n        left: e.originalEvent.clientX - 150 + \"px\",\n      });\n\n      $(\".bjy-user-layer\").toggle();\n    },\n  },\n  created() {\n    let eventEmitter = BJY.eventEmitter;\n    // 监听人数变化\n    eventEmitter.on(eventEmitter.USER_COUNT_CHANGE, function (e, data) {\n      $(\"#user-count\").text(\"(\" + data.userCount + \")\");\n    });\n  },\n  mounted() {\n    let eventEmitter = BJY.eventEmitter;\n    let me = this;\n\n    BJY.UserList.create({\n      element: $(\"#user-list\"),\n      renderUser: function (user, width, height) {\n        return {\n          id: user.id,\n          name: user.name,\n          number: user.number,\n          // 头像需压缩\n          avatar: BJY.compressImage({\n            url: user.avatar,\n            width: width,\n            height: height,\n          }),\n          avatar2x: BJY.compressImage({\n            url: user.avatar,\n            width: width * 2,\n            height: height * 2,\n          }),\n          // 根据用户类型，配置角色的英文和本地语言\n          role: userRoleMap[user.type].en,\n          localRole: userRoleMap[user.type].cn,\n        };\n      },\n    });\n\n    // 老师端在用户列表生成操作浮层\n    if (BJY.auth.isTeacher()) {\n      // 是否允许邀请上麦\n      BJY.auth.canSpeakInvite = function (target) {\n        return BJY.auth.isTeacher() && (target ? !target.group : true);\n      };\n\n      // 是否允许强制发言（与邀请发言互斥）\n      BJY.auth.canSpeakForce = function (target) {\n        return false;\n        // 组内用户不允许被强制发言\n        return BJY.auth.isTeacher() && (target ? !target.group : true);\n      };\n      $(\".user-list\").delegate(\".bjy-user-item\", \"click\", function (e) {\n        event.stopPropagation();\n        let number = e.currentTarget.dataset.number;\n        let user = BJY.data.user.findByNumber(number);\n        // user不存在到服务器获取\n        if (!user) {\n          eventEmitter.one(eventEmitter.USER_SEARCH_RES, function (event, data) {\n            if (data.result && data.result.length > 0) {\n              user = data.result[0];\n              BJY.data.user.add(user);\n              me.lastUser = user;\n              me.setLayer(false, e);\n            }\n          });\n          eventEmitter.trigger(eventEmitter.USER_SEARCH_REQ, {\n            query: userNumber,\n            field: \"number\",\n          });\n        } else {\n          me.lastUser = user;\n          me.setLayer(false, e);\n        }\n      });\n\n      $(\"#app\").delegate(\".bjy-user-layer\", \"click\", function (event) {\n        event.stopPropagation();\n      });\n\n      $(\"#app\").click(function () {\n        $(\".bjy-user-layer\") && $(\".bjy-user-layer\").hide();\n      });\n    } else {\n      // 学生端接收邀请发言信令\n      let userSpeak = BJY.userSpeak;\n      eventEmitter.on(eventEmitter.SPEAK_INVITE_CONFIRM, function () {\n        let res = confirm(\"老师邀请你上麦发言\");\n        if (res) {\n          userSpeak.processInvite(true);\n        } else {\n          userSpeak.processInvite(false);\n        }\n      });\n    }\n  },\n  beforeDestroy() {},\n};\n</script>\n\n<style lang=\"scss\">\n//@import url() 引入公共css类\n.bjy-user-layer {\n  position: fixed;\n}\n</style>\n"]}]}