{"remainingRequest":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/ModalPanel/Quiz.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/ModalPanel/Quiz.vue","mtime":1611227050000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":1584009001591},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/babel-loader/lib/index.js","mtime":1615566678361},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":1584009001591},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js","mtime":1615566687412}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmNvbnN0IGV2ZW50RW1pdHRlciA9IEJKWS5ldmVudEVtaXR0ZXI7CmNvbnN0IGF1dGggPSBCSlkuYXV0aDsKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgIGlzVGVhY2hlcjogYXV0aC5pc1RlYWNoZXIoKSwKICAgICAgZm9yY2VKb2luOiBmYWxzZQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIG9wZW4oZGF0YSkgewogICAgICB0aGlzLnZpc2libGUgPSB0cnVlOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgIXRoaXMuaXNUZWFjaGVyICYmCiAgICAgICAgICBCSlkucXVpelN0dWRlbnQub3Blbih7CiAgICAgICAgICAgIC8vIOWNoOS9jeWFg+e0oAogICAgICAgICAgICBlbGVtZW50OiAkKCIjcXVpei1wbGFjZWhvbGRlciAucGxhY2Vob2xkZXIiKVswXSwKICAgICAgICAgICAgcmVwbGFjZTogZmFsc2UsCiAgICAgICAgICAgIC8vIOaYr+WQpuW8uuWItuWPguWKoCDlrabnlJ/nq6/nrZTpopjml7bkvKDlhaUKICAgICAgICAgICAgZm9yY2VKb2luOiBkYXRhLmZvcmNlSm9pbiwKICAgICAgICAgICAgLy8g6K+V5Y23aWQKICAgICAgICAgICAgcXVpeklkOiBkYXRhLnF1aXpJZCwKICAgICAgICAgICAgLy8g6K+V6aKY562U5qGIIOWtpueUn+err+afpeeci+etlOahiOaXtuS8oOWFpQogICAgICAgICAgICBzb2x1dGlvbjogZGF0YS5zb2x1dGlvbiwKCiAgICAgICAgICAgIC8vIOWwsee7quWbnuiwgwogICAgICAgICAgICBvblJlYWR5OiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICAgICAgLy8g6ZSZ6K+v5Zue6LCDCiAgICAgICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uICgpIHt9LAogICAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGNsb3NlKCkgewogICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTsKICAgIH0sCiAgICBpbml0VGVhY2hlcigpIHsKICAgICAgQkpZLnF1aXpUZWFjaGVyLmluaXQoewogICAgICAgIGVsZW1lbnQ6ICQoIiNxdWl6LXBsYWNlaG9sZGVyIC5wbGFjZWhvbGRlciIpWzBdLAogICAgICAgIHJlcGxhY2U6IGZhbHNlLAogICAgICAgIC8vIOmUmeivr+WbnuiwgwogICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICBhbGVydChkYXRhLm1zZyk7CiAgICAgICAgfSwKICAgICAgICAvLyDlvIDlp4vlsI/mtYvliY3lm57osIPvvIzov5Tlm54gdHJ1ZSDkvJrlvIDlp4vmiafooYzlsI/mtYvvvIzov5Tlm55mYWxzZeS4jeS8muaJp+ihjO+8jOWPr+eUqOS6juadoeS7tuWIpOaWrQogICAgICAgIG9uQmVmb3JlU3RhcnRRdWl6OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIC8vIOW8gOWni+WPkeW4g+ivleWNt+WJjeWbnuiwg++8jOi/lOWbniB0cnVlIOS8muaJp+ihjOWPkeW4g++8jOi/lOWbnmZhbHNl5LiN5Lya5omn6KGM77yM5Y+v55So5LqO5p2h5Lu25Yik5patCiAgICAgICAgb25CZWZvcmVQdWJsaXNoU29sdXRpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCiAgICAgICAgb25CZWZvcmVRdWl6RGVsZXRlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBwcm9taXNlID0gJC5EZWZlcnJlZCgpOwogICAgICAgICAgICB2YXIgc3VyZSA9IGNvbmZpcm0oJ+ehruWumuimgeWIoOmZpOWQl++8nycpOwogICAgICAgICAgICBpZiAoc3VyZSkgewogICAgICAgICAgICAgIHByb21pc2UucmVzb2x2ZSh0cnVlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBwcm9taXNlLnJlc29sdmUoZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBwcm9taXNlCiAgICAgICAgfSwKICAgICAgfSk7CiAgICB9LAogICAgaW5pdFN0dWRlbnQoKSB7CiAgICAgIEJKWS5xdWl6U3R1ZGVudC5pbml0KCk7CiAgICB9LAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGV2ZW50RW1pdHRlcgogICAgICAub24oCiAgICAgICAgLy8g5bCP5rWL5byA5aeL5LqL5Lu2CiAgICAgICAgZXZlbnRFbWl0dGVyLlFVSVpfU1RBUlQsCiAgICAgICAgKGUsIGRhdGEpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOwogICAgICAgICAgdGhpcy5mb3JjZUpvaW4gPSBkYXRhLmZvcmNlSm9pbjsKICAgICAgICAgIHRoaXMub3BlbihkYXRhKTsKICAgICAgICB9CiAgICAgICkKICAgICAgLy8g5rWL6aqM57uT5p2fCiAgICAgIC5vbihldmVudEVtaXR0ZXIuUVVJWl9FTkQsIChlLCBkYXRhKSA9PiB7CiAgICAgICAgIXRoaXMuaXNUZWFjaGVyICYmIHRoaXMuY2xvc2UoKTsKICAgICAgfSkKICAgICAgLm9uKGV2ZW50RW1pdHRlci5RVUlaX0NMT1NFLCAoZSwgZGF0YSkgPT4gewogICAgICAgIGlmICghZGF0YS5mb3JjZSAmJiAkLmlzRW1wdHlPYmplY3QoZGF0YS5zb2x1dGlvbikpIHsKICAgICAgICAgICAgYWxlcnQoJ+ivt+iHs+WwkeWbnuetlOS4gOS4qumimOebruS5i+WQjuaPkOS6pCcpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuY2xvc2UoKTsKICAgICAgfSkKICAgICAgLm9uKAogICAgICAgIC8vIOafpeeci+Wwj+a1i+etlOahiAogICAgICAgIGV2ZW50RW1pdHRlci5RVUlaX1NPTFVUSU9OLAogICAgICAgIChlLCBkYXRhKSA9PiB7CiAgICAgICAgICB0aGlzLmZvcmNlSm9pbiA9IGZhbHNlOwogICAgICAgICAgdGhpcy5vcGVuKGRhdGEpOwogICAgICAgIH0KICAgICAgKQogICAgICAub24oZXZlbnRFbWl0dGVyLlFVSVpfU1VCTUlULCAoZSwgZGF0YSkgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOwogICAgICAgIHRoaXMuY2xvc2UoKTsKICAgICAgfSkKICAgICAgLm9uKCJ0b2dnbGVfcXVpel9kaWFsb2ciLCAoZSwgZGF0YSkgPT4gewogICAgICAgIHRoaXMudmlzaWJsZSA/IHRoaXMuY2xvc2UoKSA6IHRoaXMub3BlbigpOwogICAgICB9KTsKICAgIGV2ZW50RW1pdHRlci50cmlnZ2VyKGV2ZW50RW1pdHRlci5RVUlaX1JFUSk7CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pc1RlYWNoZXIgPyB0aGlzLmluaXRUZWFjaGVyKCkgOiB0aGlzLmluaXRTdHVkZW50KCk7CiAgfSwKICBiZWZvcmVEZXN0cm95KCkge30sCn07Cg=="},{"version":3,"sources":["Quiz.vue"],"names":[],"mappings":";;;;;;;;;;;AAWA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Quiz.vue","sourceRoot":"src/components/ModalPanel","sourcesContent":["<!-- 小测组件 -->\n<template>\n  <div v-show=\"visible\" :class=\"isTeacher ? 'teacher' : 'student'\" id=\"quiz-placeholder\">\n    <div class=\"close-bar\">\n      <span v-show=\"isTeacher || !forceJoin\" @click=\"close\" class=\"bjy-close\">X</span>\n    </div>\n    <div class=\"placeholder\"></div>\n  </div>\n</template>\n\n<script>\nconst eventEmitter = BJY.eventEmitter;\nconst auth = BJY.auth;\n\nexport default {\n  data() {\n    return {\n      visible: false,\n      isTeacher: auth.isTeacher(),\n      forceJoin: false\n    };\n  },\n  methods: {\n    open(data) {\n      this.visible = true;\n      this.$nextTick(() => {\n        !this.isTeacher &&\n          BJY.quizStudent.open({\n            // 占位元素\n            element: $(\"#quiz-placeholder .placeholder\")[0],\n            replace: false,\n            // 是否强制参加 学生端答题时传入\n            forceJoin: data.forceJoin,\n            // 试卷id\n            quizId: data.quizId,\n            // 试题答案 学生端查看答案时传入\n            solution: data.solution,\n\n            // 就绪回调\n            onReady: function () {},\n            // 错误回调\n            onError: function () {},\n          });\n      });\n    },\n    close() {\n      this.visible = false;\n    },\n    initTeacher() {\n      BJY.quizTeacher.init({\n        element: $(\"#quiz-placeholder .placeholder\")[0],\n        replace: false,\n        // 错误回调\n        onError: function (data) {\n          alert(data.msg);\n        },\n        // 开始小测前回调，返回 true 会开始执行小测，返回false不会执行，可用于条件判断\n        onBeforeStartQuiz: function () {\n          return true;\n        },\n        // 开始发布试卷前回调，返回 true 会执行发布，返回false不会执行，可用于条件判断\n        onBeforePublishSolution: function () {\n          return true;\n        },\n        onBeforeQuizDelete: function () {\n            var promise = $.Deferred();\n            var sure = confirm('确定要删除吗？');\n            if (sure) {\n              promise.resolve(true);\n            } else {\n              promise.resolve(false);\n            }\n            return promise\n        },\n      });\n    },\n    initStudent() {\n      BJY.quizStudent.init();\n    },\n  },\n  created() {\n    eventEmitter\n      .on(\n        // 小测开始事件\n        eventEmitter.QUIZ_START,\n        (e, data) => {\n          console.log(data);\n          this.forceJoin = data.forceJoin;\n          this.open(data);\n        }\n      )\n      // 测验结束\n      .on(eventEmitter.QUIZ_END, (e, data) => {\n        !this.isTeacher && this.close();\n      })\n      .on(eventEmitter.QUIZ_CLOSE, (e, data) => {\n        if (!data.force && $.isEmptyObject(data.solution)) {\n            alert('请至少回答一个题目之后提交');\n            return;\n        }\n        this.close();\n      })\n      .on(\n        // 查看小测答案\n        eventEmitter.QUIZ_SOLUTION,\n        (e, data) => {\n          this.forceJoin = false;\n          this.open(data);\n        }\n      )\n      .on(eventEmitter.QUIZ_SUBMIT, (e, data) => {\n        console.log(data);\n        this.close();\n      })\n      .on(\"toggle_quiz_dialog\", (e, data) => {\n        this.visible ? this.close() : this.open();\n      });\n    eventEmitter.trigger(eventEmitter.QUIZ_REQ);\n  },\n  mounted() {\n    this.isTeacher ? this.initTeacher() : this.initStudent();\n  },\n  beforeDestroy() {},\n};\n</script>\n\n<style lang=\"scss\" scoped>\n#quiz-placeholder {\n  position: absolute;\n  z-index: 10;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);\n  background: #fff;\n\n  &.student {\n    width: 600px;\n    height: 80%;\n\n    .close-bar {\n      position: absolute;\n      width: 100%;\n      top: 0;\n    }\n    .placeholder {\n      top: 30px;\n      bottom: 0;\n      position: absolute;\n      width: 100%;\n    }\n  }\n  &.teacher {\n    width: 800px;\n  }\n\n  .close-bar {\n    background: #232323;\n    height: 30px;\n    text-align: right;\n\n    .bjy-close {\n      line-height: 30px;\n      color: #fff;\n      font-size: 20px;\n      margin-right: 16px;\n      cursor: pointer;\n    }\n  }\n}\n</style>\n"]}]}