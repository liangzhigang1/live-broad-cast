{"remainingRequest":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/InteractionPanel/MessageList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/InteractionPanel/MessageList.vue","mtime":1611227050000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB1c2VyUm9sZU1hcCBmcm9tICcuL2NvbW1vbi9yb2xlTWFwJwpjb25zdCBhdXRoID0gQkpZLmF1dGg7CmNvbnN0IHN0b3JlID0gQkpZLnN0b3JlOwpjb25zdCBldmVudEVtaXR0ZXIgPSBCSlkuZXZlbnRFbWl0dGVyOwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEgKCkgewogICAgcmV0dXJuIHt9CiAgfSwKICBtZXRob2RzOiB7fSwKICBjcmVhdGVkICgpIHsKICAgIC8vIOaUtuWIsOaWsOa2iOaBr+aXtnRhYuagj+WvueW6lHRhYue7meWHuuaPkOekugogICAgZXZlbnRFbWl0dGVyLm9uKAogICAgICBldmVudEVtaXR0ZXIuTUVTU0FHRV9SRUNFSVZFLAogICAgICBmdW5jdGlvbiAoZSwgZGF0ZSkgewogICAgICAgIHZhciBlbGVtZW50ID0gJCgnI2J0bi1tZXNzYWdlLWxpc3QnKQogICAgICAgIGlmICghZWxlbWVudC5oYXNDbGFzcygnYWN0aXZlJykpIHsKICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2hhcy1uZXcnKQogICAgICAgIH0KICAgICAgfQogICAgKQogIH0sCiAgbW91bnRlZCAoKSB7CiAgICAvLyDlhazlkYoKICAgIEJKWS5Ob3RpY2UuY3JlYXRlKHsKICAgICAgZWxlbWVudDogJCgnI21lc3NhZ2UtcGFuZWwgLm5vdGljZScpLCAvLyDniLblrrnlmagKICAgICAgcmVwbGFjZTogZmFsc2UsCiAgICAgIGRlZmF1bHRDb250ZW50OiAn6L+Z6YeM56m656m65aaC5LmfLi4uJywgLy8g6buY6K6k5peg5YWs5ZGK5pe25pi+56S65paH5pysCiAgICAgIG1heExlbmd0aDogMTQwLCAvLyDlhazlkYrmlofmnKzmnIDlpKfplb/luqYKICAgICAgY29udGVudFBsYWNlaG9sZGVyOiAn6K+36L6T5YWl5YWs5ZGK5q2j5paH5YaF5a65JywgLy8g5YWs5ZGK5paH5pys57yW6L6R5qGG5o+Q56S6CiAgICAgIGxpbmtQbGFjZWhvbGRlcjogJ+ivt+i+k+WFpeWFrOWRiui3s+i9rOmTvuaOpe+8iOWPr+mAie+8iScsIC8vIOWFrOWRiumTvuaOpee8lui+keahhuaPkOekugogICAgICBsaW5rRXJyb3JIaW50OiAnVVJMIOagvOW8j+mUmeivrycsIC8vIHVybCDplJnor6/mj5DnpLoKICAgICAgY2FuRWRpdDogYXV0aC5pc1RlYWNoZXIoKSB8fCBhdXRoLmlzQXNzaXN0YW50KCkKICAgIH0pCiAgICAvLyDliJvlu7rmtojmga/liJfooajnu4Tku7YKICAgIEJKWS5NZXNzYWdlTGlzdC5jcmVhdGUoewogICAgICBlbGVtZW50OiAkKCcjbWVzc2FnZS1wYW5lbCAubWVzc2FnZS1saXN0JyksCiAgICAgIHJlbmRlckVtb2ppOiBmdW5jdGlvbiAobmFtZSwgdXJsKSB7CiAgICAgICAgaWYgKEJKWS5pc0FsaWNsb3VkSW1hZ2UodXJsKSkgewogICAgICAgICAgcmV0dXJuICc8aW1nIG9uZHJhZ3N0YXJ0PSJyZXR1cm4gZmFsc2UiIHNyYz0iJyArCiAgICAgICAgICAgICAgICAgICAgICAgICh1cmwgKyAnQDEwMHdfMWVfMWwucG5nJykgKwogICAgICAgICAgICAgICAgICAgICAgICAnIiBzcmNzZXQ9IicgKwogICAgICAgICAgICAgICAgICAgICAgICAodXJsICsgJ0AyMDB3XzFlXzFsLnBuZycpICsKICAgICAgICAgICAgICAgICAgICAgICAgJyAyeCI+JwogICAgICAgIH0KICAgICAgICByZXR1cm4gJzxpbWcgb25kcmFnc3RhcnQ9InJldHVybiBmYWxzZSIgc3JjPSInICsgdXJsICsgJyI+JwogICAgICB9LAogICAgICByZW5kZXJJbWFnZTogZnVuY3Rpb24gKHVybCkgewogICAgICAgIGlmIChCSlkuaXNBbGljbG91ZEltYWdlKHVybCkpIHsKICAgICAgICAgIHJldHVybiAnPGltZyBvbmRyYWdzdGFydD0icmV0dXJuIGZhbHNlIiBzcmM9IicgKwogICAgICAgICAgICAgICAgICAgICAgICAodXJsICsgJ0AxMDB3XzFlXzFsLnBuZycpICsKICAgICAgICAgICAgICAgICAgICAgICAgJyIgc3Jjc2V0PSInICsKICAgICAgICAgICAgICAgICAgICAgICAgKHVybCArICdAMjAwd18xZV8xbC5wbmcnKSArCiAgICAgICAgICAgICAgICAgICAgICAgICcgMngiPicKICAgICAgICB9CiAgICAgICAgcmV0dXJuICc8aW1nIG9uZHJhZ3N0YXJ0PSJyZXR1cm4gZmFsc2UiIHNyYz0iJyArIHVybCArICciPicKICAgICAgfSwKICAgICAgcmVuZGVyVXNlcjogZnVuY3Rpb24gKHVzZXIsIHdpZHRoLCBoZWlnaHQpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaWQ6IHVzZXIuaWQsCiAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsCiAgICAgICAgICBudW1iZXI6IHVzZXIubnVtYmVyLAogICAgICAgICAgLy8g5aS05YOP6ZyA5Y6L57ypCiAgICAgICAgICBhdmF0YXI6IEJKWS5jb21wcmVzc0ltYWdlKHsKICAgICAgICAgICAgdXJsOiB1c2VyLmF2YXRhciwKICAgICAgICAgICAgd2lkdGg6IHdpZHRoLAogICAgICAgICAgICBoZWlnaHQ6IGhlaWdodAogICAgICAgICAgfSksCiAgICAgICAgICBhdmF0YXIyeDogQkpZLmNvbXByZXNzSW1hZ2UoewogICAgICAgICAgICB1cmw6IHVzZXIuYXZhdGFyLAogICAgICAgICAgICB3aWR0aDogd2lkdGggKiAyLAogICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCAqIDIKICAgICAgICAgIH0pLAogICAgICAgICAgLy8g5qC55o2u55So5oi357G75Z6L77yM6YWN572u6KeS6Imy55qE6Iux5paH5ZKM5pys5Zyw6K+t6KiACiAgICAgICAgICByb2xlOiB1c2VyUm9sZU1hcFt1c2VyLnR5cGVdLmVuLAogICAgICAgICAgbG9jYWxSb2xlOiB1c2VyUm9sZU1hcFt1c2VyLnR5cGVdLmNuLAogICAgICAgICAgdHlwZTogdXNlci50eXBlCiAgICAgICAgfQogICAgICB9LAogICAgICBsb2FkRGlzdGFuY2U6IDAKICAgIH0pCgogICAgLy8g5Yib5bu65raI5oGv5Y+R6YCB57uE5Lu2CiAgICBCSlkuTWVzc2FnZVNlbmRlci5jcmVhdGUoewogICAgICBlbGVtZW50OiAkKCcjbWVzc2FnZS1wYW5lbCAubWVzc2FnZS1zZW5kZXInKSwKICAgICAgY2FuU2VuZEVtb2ppOiB0cnVlLAogICAgICBjYW5TZW5kSW1hZ2U6IHRydWUsCiAgICAgIG11bHRpbGluZTogdHJ1ZSwKICAgICAgbWVzc2FnZU1heExlbmd0aDogMTQwLAogICAgICBwbGFjZWhvbGRlcjogJ+ivt+i+k+WFpS4uLicsCiAgICAgIGVtb3Rpb25MaXN0OiB7CiAgICAgICAgZW1vdGlvblBlclJvdzogNiwKICAgICAgICByb3dQZXJQYWdlOiA0CiAgICAgIH0sCiAgICAgIGltYWdlVXBsb2FkZXI6IHsKICAgICAgICAgIGFjdGlvbjogJy93ZWIvZG9jL3VwbG9hZENoYXRGaWxlJywKICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgcm9vbV9pZDogc3RvcmUuZ2V0KCdjbGFzcy5pZCcpLAogICAgICAgICAgICB0b2tlbjogc3RvcmUuZ2V0KCd0b2tlbicpCiAgICAgICAgICB9LAogICAgICAgICAgZmlsZU5hbWU6ICdGaWxlZGF0YScKICAgICAgfSwKICAgIH0pCiAgfSwKICBiZWZvcmVEZXN0cm95ICgpIHt9Cn0K"},{"version":3,"sources":["MessageList.vue"],"names":[],"mappings":";;;;;;;;;;;;AAYA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MessageList.vue","sourceRoot":"src/components/InteractionPanel","sourcesContent":["<template>\n  <div id=\"message-panel\">\n    <div class=\"notice\">\n    </div>\n    <div class=\"message-list\">\n    </div>\n    <div class=\"message-sender\">\n    </div>\n  </div>\n</template>\n\n<script>\nimport userRoleMap from './common/roleMap'\nconst auth = BJY.auth;\nconst store = BJY.store;\nconst eventEmitter = BJY.eventEmitter;\n\nexport default {\n  data () {\n    return {}\n  },\n  methods: {},\n  created () {\n    // 收到新消息时tab栏对应tab给出提示\n    eventEmitter.on(\n      eventEmitter.MESSAGE_RECEIVE,\n      function (e, date) {\n        var element = $('#btn-message-list')\n        if (!element.hasClass('active')) {\n          element.addClass('has-new')\n        }\n      }\n    )\n  },\n  mounted () {\n    // 公告\n    BJY.Notice.create({\n      element: $('#message-panel .notice'), // 父容器\n      replace: false,\n      defaultContent: '这里空空如也...', // 默认无公告时显示文本\n      maxLength: 140, // 公告文本最大长度\n      contentPlaceholder: '请输入公告正文内容', // 公告文本编辑框提示\n      linkPlaceholder: '请输入公告跳转链接（可选）', // 公告链接编辑框提示\n      linkErrorHint: 'URL 格式错误', // url 错误提示\n      canEdit: auth.isTeacher() || auth.isAssistant()\n    })\n    // 创建消息列表组件\n    BJY.MessageList.create({\n      element: $('#message-panel .message-list'),\n      renderEmoji: function (name, url) {\n        if (BJY.isAlicloudImage(url)) {\n          return '<img ondragstart=\"return false\" src=\"' +\n                        (url + '@100w_1e_1l.png') +\n                        '\" srcset=\"' +\n                        (url + '@200w_1e_1l.png') +\n                        ' 2x\">'\n        }\n        return '<img ondragstart=\"return false\" src=\"' + url + '\">'\n      },\n      renderImage: function (url) {\n        if (BJY.isAlicloudImage(url)) {\n          return '<img ondragstart=\"return false\" src=\"' +\n                        (url + '@100w_1e_1l.png') +\n                        '\" srcset=\"' +\n                        (url + '@200w_1e_1l.png') +\n                        ' 2x\">'\n        }\n        return '<img ondragstart=\"return false\" src=\"' + url + '\">'\n      },\n      renderUser: function (user, width, height) {\n        return {\n          id: user.id,\n          name: user.name,\n          number: user.number,\n          // 头像需压缩\n          avatar: BJY.compressImage({\n            url: user.avatar,\n            width: width,\n            height: height\n          }),\n          avatar2x: BJY.compressImage({\n            url: user.avatar,\n            width: width * 2,\n            height: height * 2\n          }),\n          // 根据用户类型，配置角色的英文和本地语言\n          role: userRoleMap[user.type].en,\n          localRole: userRoleMap[user.type].cn,\n          type: user.type\n        }\n      },\n      loadDistance: 0\n    })\n\n    // 创建消息发送组件\n    BJY.MessageSender.create({\n      element: $('#message-panel .message-sender'),\n      canSendEmoji: true,\n      canSendImage: true,\n      multiline: true,\n      messageMaxLength: 140,\n      placeholder: '请输入...',\n      emotionList: {\n        emotionPerRow: 6,\n        rowPerPage: 4\n      },\n      imageUploader: {\n          action: '/web/doc/uploadChatFile',\n          data: {\n            room_id: store.get('class.id'),\n            token: store.get('token')\n          },\n          fileName: 'Filedata'\n      },\n    })\n  },\n  beforeDestroy () {}\n}\n</script>\n\n<style lang='scss'>\n//@import url(); 引入公共css类\n#message-panel {\n  width: 100%;\n  height: 100%;\n\n  .notice {\n    position: absolute;\n    top: 0;\n    z-index: 1;\n    background: #fff;\n    width: 100%;\n    border-top: 1px solid #ddd;\n  }\n\n  .bjy-message-list {\n    bottom: 110px;\n    height: unset;\n    top: 32px;\n  }\n\n  .bjy-message-sender {\n    position: absolute;\n    bottom: 10px;\n    width: 100%;\n  }\n}\n</style>\n"]}]}