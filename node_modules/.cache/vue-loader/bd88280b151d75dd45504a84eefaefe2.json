{"remainingRequest":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/WhiteBoard.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/WhiteBoard.vue","mtime":1611227050000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLy9AaW1wb3J0IHVybCgpOyDlvJXlhaXlhazlhbFjc3PnsbsKLyrnmb3mnb/moLflvI8qLwojd2hpdGVib2FyZCB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMDsKICBib3R0b206IDA7CiAgbGVmdDogMzBweDsKICByaWdodDogMzBweDsKCiAgLmJqeS10b29sYmFyIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGJvdHRvbTogMDsKICB9CgogIC8q55m95p2/5bel5YW3Ki8KICAubmV4dC1wYWdlLAogIC5wcmUtcGFnZSB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogMzBweDsKICAgIHRvcDogMDsKICAgIGJvdHRvbTogMDsKICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC41czsKICAgIGNvbG9yOiB0cmFuc3BhcmVudDsKCiAgICAuZm9yYmlkOmhvdmVyIHsKICAgICAgY3Vyc29yOiBub3QtYWxsb3dlZDsKICAgIH0KICB9CiAgLnByZS1wYWdlIHsKICAgIGxlZnQ6IC0zMHB4OwogIH0KICAubmV4dC1wYWdlIHsKICAgIHJpZ2h0OiAtMzBweDsKICB9CiAgLnByZS1wYWdlOmhvdmVyIHsKICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC40KTsKICB9CiAgLm5leHQtcGFnZTpob3ZlciB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuNCk7CiAgfQogIC5pY29uLWNoZXZyb24tbGVmdCwKICAuaWNvbi1jaGV2cm9uLXJpZ2h0IHsKICAgIGZvbnQtc2l6ZTogNDBweDsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHRvcDogNTAlOwogICAgbWFyZ2luLXRvcDogLTI1cHg7CiAgICBjb2xvcjogI2ZmZjsKICB9CiAgLmhhcy1wYWdlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICB9Cn0K"},{"version":3,"sources":["WhiteBoard.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"WhiteBoard.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"whiteboard\">\n    <div class=\"placeholder\"></div>\n    <div v-if=\"canChangePage\" class=\"pre-page\">\n      <span class=\"icon-chevron-left\" :class=\"{ forbid: !canPrePage }\"><</span>\n    </div>\n    <div v-if=\"canChangePage\" class=\"next-page\">\n      <span class=\"icon-chevron-right\" :class=\"{ forbid: !canNextPage }\">></span>\n    </div>\n\n    <div v-show=\"canPaint\" class=\"bjy-toolbar\">\n      <div class=\"bjy-toolbar-placeholder\">\n        \n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nconst eventEmitter = BJY.eventEmitter;\nconst auth = BJY.auth;\nconst store = BJY.store;\nconst config = BJY.config;\n\nexport default {\n  components: {},\n  data() {\n    return {\n      canPrePage: false,\n      canNextPage: false,\n      pageData: null,\n      forbidChange: true,\n      isTeacher: auth.isTeacher(),\n      canStudentPanit: false\n    };\n  },\n  computed: {\n    canChangePage() {\n      return auth.isTeacher() || !this.forbidChange;\n    },\n    canPaint() {\n      return auth.isTeacher() || this.canStudentPanit;\n    }\n  },\n  methods: {\n    setPageAuth() {\n      var prePage = $(\".icon-chevron-left\");\n      var nextPage = $(\".icon-chevron-right\");\n\n      if (this.canPrePage) {\n        prePage.addClass(\"has-page\");\n      } else {\n        prePage.removeClass(\"has-page\");\n      }\n      if (this.canNextPage) {\n        nextPage.addClass(\"has-page\");\n      } else {\n        nextPage.removeClass(\"has-page\");\n      }\n    },\n  },\n  created() {\n    this.pageData = BJY.data.page;\n    this.canPrePage = this.pageData.getClientPage() > 0;\n    this.canNextPage = this.pageData.getClientPage() < this.pageData.getMaxPage;\n  },\n  mounted() {\n    var element = $(\"#whiteboard\");\n\n    // 文档白板\n    BJY.Whiteboard.create({\n      element: element.find(\".placeholder\"),\n      fit: 1, // 1 自适应  2 撑满容器\n    });\n\n    // 画笔工具\n    BJY.PainterToolBar.create({\n        // DOM 父元素\n        element: $(\".bjy-toolbar-placeholder\"),\n        replace: true,\n        // 是否水平放置\n        isVertical: false,\n        // 是否使用选择工具\n        canUseSelectTool: true,\n        //是否使用粉笔工具\n        canUsePencilTool: true,\n        //是否使用图形工具\n        canUseShapeTool: true,\n        //是否使用文本工具\n        canUseFontTool: true,\n        //是否有调色板\n        canUsePaletteTool: true,\n        //是否使用删除键\n        canUseDeleteTool: true,\n        //是否使用激光笔\n        canUsePointTool: true,\n      });\n\n    this.setPageAuth();\n\n    // 白板工具事件\n    element.find(\".pre-page\").on(\"click\", () => {\n      if (this.canPrePage && this.canChangePage) {\n        eventEmitter.trigger(eventEmitter.PAGE_PREV_TRIGGER);\n      }\n    });\n\n    element.find(\".next-page\").on(\"click\", () => {\n      if (this.canNextPage && this.canChangePage) {\n        eventEmitter.trigger(eventEmitter.PAGE_NEXT_TRIGGER);\n      }\n    });\n\n    eventEmitter\n      .on(eventEmitter.WHITEBOARD_LAYOUT_CHANGE, (e, data) => {\n        // 重新设置白板的高度并让其居中\n      })\n      .on(eventEmitter.CLIENT_PAGE_CHANGE, () => {\n        console.log(\"客户端翻页\");\n      })\n      .on(eventEmitter.PAGE_CHANGE_END, (e, data) => {\n        var currentPage = this.pageData.getClientPage();\n        var maxPage = this.pageData.getMaxPage();\n\n        if (currentPage > 0) {\n          this.canPrePage = true;\n        } else {\n          this.canPrePage = false;\n        }\n        if (currentPage < maxPage) {\n          this.canNextPage = true;\n        } else {\n          this.canNextPage = false;\n        }\n        this.setPageAuth();\n      })\n      .on(eventEmitter.STUDENT_PPT_AUTH_CHANGE, (e, data) => {\n        console.log(data.forbid);\n        this.forbidChange = data.forbid;\n      })\n      .on(eventEmitter.SWITCH_STUDENT_PAINT, (e, data) => {\n        if (auth.isStudent()) {\n          var authList = data.studentPaintAuth;\n          authList.filter(userNumber => {\n            return store.get('user.number') === userNumber;\n          })\n          this.canStudentPanit = authList.length > 0;\n          eventEmitter.trigger(\n              eventEmitter.PAINT_AUTH_CHANGE,\n              {\n                  canPaint: this.canStudentPanit,\n                  fromTeacher: true,\n                  cache: 1\n              }\n          );\n        }\n      })\n      .on(eventEmitter.MEDIA_PUBLISH, (e, data) => {\n        if (data.audioOn === false && data.videoOn === false && data.user.id == store.get('user.id')) {\n          this.canStudentPanit = false\n        }\n      });\n  },\n  beforeDestroy() {},\n};\n</script>\n\n<style lang=\"scss\">\n//@import url(); 引入公共css类\n/*白板样式*/\n#whiteboard {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 30px;\n  right: 30px;\n\n  .bjy-toolbar {\n    position: absolute;\n    bottom: 0;\n  }\n\n  /*白板工具*/\n  .next-page,\n  .pre-page {\n    position: absolute;\n    width: 30px;\n    top: 0;\n    bottom: 0;\n    transition: background-color 0.5s;\n    color: transparent;\n\n    .forbid:hover {\n      cursor: not-allowed;\n    }\n  }\n  .pre-page {\n    left: -30px;\n  }\n  .next-page {\n    right: -30px;\n  }\n  .pre-page:hover {\n    background-color: rgba(0, 0, 0, 0.4);\n  }\n  .next-page:hover {\n    background-color: rgba(0, 0, 0, 0.4);\n  }\n  .icon-chevron-left,\n  .icon-chevron-right {\n    font-size: 40px;\n    position: absolute;\n    top: 50%;\n    margin-top: -25px;\n    color: #fff;\n  }\n  .has-page {\n    cursor: pointer;\n  }\n}\n</style>\n"]}]}