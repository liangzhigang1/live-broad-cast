{"remainingRequest":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/babel-loader/lib/index.js!/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/ModalPanel/RollCallTeacher.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/src/components/ModalPanel/RollCallTeacher.vue","mtime":1611227050000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzg/Downloads/bjy-live-vue-demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvVXNlcnMvbGlhbmd6Zy9Eb3dubG9hZHMvYmp5LWxpdmUtdnVlLWRlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGxhbmd1YWdlIGZyb20gIi4uLy4uL2xhbmd1YWdlL21haW4iOwp2YXIgYXV0aCA9IEJKWS5hdXRoOwp2YXIgZXZlbnRFbWl0dGVyID0gQkpZLmV2ZW50RW1pdHRlcjsKdmFyIFJPTExfQ0FMTF9TVEFUVVMgPSB7CiAgYmVmb3JlOiAwLAogIGluZzogMSwKICBhZnRlcjogMgp9OwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHZhciBfcmVmOwoKICAgIHJldHVybiBfcmVmID0gewogICAgICBsYW5ndWFnZTogbGFuZ3VhZ2UsCiAgICAgIHN0YXR1czogMCwKICAgICAgaXNUZWFjaGVyOiBhdXRoLmlzVGVhY2hlcigpLAogICAgICByZXN1bHRUaW1lcjogNjAsCiAgICAgIG5leHRUaW1lcjogNjAsCiAgICAgIHJlc3VsdDogIiIsCiAgICAgIHJvbGxDYWxsRHVyYXRpb246IDYwLAogICAgICB2aXNpYmxlOiBmYWxzZQogICAgfSwgX2RlZmluZVByb3BlcnR5KF9yZWYsICJzdGF0dXMiLCBST0xMX0NBTExfU1RBVFVTLmJlZm9yZSksIF9kZWZpbmVQcm9wZXJ0eShfcmVmLCAic3RhdHVzTWFwIiwgUk9MTF9DQUxMX1NUQVRVUyksIF9kZWZpbmVQcm9wZXJ0eShfcmVmLCAicmVzdWx0SW50ZXJ2YWwiLCBudWxsKSwgX2RlZmluZVByb3BlcnR5KF9yZWYsICJhY2tDb3VudCIsIDApLCBfZGVmaW5lUHJvcGVydHkoX3JlZiwgIm5hY2tDb3VudCIsIDApLCBfcmVmOwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgZXZlbnRFbWl0dGVyLm9uKCJ0b2dnbGVfcm9sbF9jYWxsIiwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5zaG93KCk7CiAgICB9KS5vbiggLy8g54K55ZCN57uT5p6cCiAgICBldmVudEVtaXR0ZXIuUk9MTF9DQUxMX1JFU1VMVCwgZnVuY3Rpb24gKGUsIGRhdGEpIHsKICAgICAgdmFyIHJlc3VsdCA9IGRhdGE7IC8vICDngrnlkI3nu5PmnpwgCgogICAgICBjb25zb2xlLmxvZyhyZXN1bHQpOwogICAgICBfdGhpcy5zdGF0dXMgPSBST0xMX0NBTExfU1RBVFVTLmFmdGVyOwogICAgICBfdGhpcy5hY2tDb3VudCA9IHJlc3VsdC5hY2tMaXN0Lmxlbmd0aDsKICAgICAgX3RoaXMubmFja0NvdW50ID0gcmVzdWx0Lm5hY2tMaXN0Lmxlbmd0aDsKICAgIH0pLm9uKCAvLyDngrnlkI3lvIDlp4sKICAgIGV2ZW50RW1pdHRlci5ST0xMX0NBTEwsIGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMucmVzdWx0VGltZXIgPSBfdGhpcy5yb2xsQ2FsbER1cmF0aW9uOwogICAgICBfdGhpcy5zdGF0dXMgPSBST0xMX0NBTExfU1RBVFVTLmluZzsKICAgICAgX3RoaXMucmVzdWx0SW50ZXJ2YWwgPSBudWxsOwogICAgICBfdGhpcy5yZXN1bHRJbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoX3RoaXMucmVzdWx0VGltZXIgPiAwKSB7CiAgICAgICAgICAtLV90aGlzLnJlc3VsdFRpbWVyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDml7bpl7TliLDkuobpnIDopoHogIHluIjnq6/kuLvliqjop6blj5Hnu5PmnZ8KICAgICAgICAgIGV2ZW50RW1pdHRlci50cmlnZ2VyKGV2ZW50RW1pdHRlci5ST0xMX0NBTExfRklOSVNIKTsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwoX3RoaXMucmVzdWx0SW50ZXJ2YWwpOwogICAgICAgIH0KICAgICAgfSwgMTAwMCk7CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7CiAgICAgIHRoaXMudmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgY2xvc2U6IGZ1bmN0aW9uIGNsb3NlKCkgewogICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTsKICAgIH0sCiAgICBzdGFydFJvbGxDYWxsOiBmdW5jdGlvbiBzdGFydFJvbGxDYWxsKCkgewogICAgICBldmVudEVtaXR0ZXIudHJpZ2dlcihldmVudEVtaXR0ZXIuUk9MTF9DQUxMX1RSSUdHRVIsIHsKICAgICAgICAvLyDlgJLorqHml7Yg56eSCiAgICAgICAgZHVyYXRpb246IHRoaXMucm9sbENhbGxEdXJhdGlvbgogICAgICB9KTsKICAgIH0sCiAgICByZUNhbGw6IGZ1bmN0aW9uIHJlQ2FsbCgpIHsKICAgICAgdGhpcy5zdGF0dXMgPSBST0xMX0NBTExfU1RBVFVTLmJlZm9yZTsKICAgIH0KICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7fQp9Ow=="},{"version":3,"sources":["RollCallTeacher.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA,OAAA,QAAA,MAAA,qBAAA;AAEA,IAAA,IAAA,GAAA,GAAA,CAAA,IAAA;AACA,IAAA,YAAA,GAAA,GAAA,CAAA,YAAA;AAEA,IAAA,gBAAA,GAAA;AACA,EAAA,MAAA,EAAA,CADA;AAEA,EAAA,GAAA,EAAA,CAFA;AAGA,EAAA,KAAA,EAAA;AAHA,CAAA;AAMA,eAAA;AACA,EAAA,IADA,kBACA;AAAA;;AACA;AACA,MAAA,QAAA,EAAA,QADA;AAEA,MAAA,MAAA,EAAA,CAFA;AAGA,MAAA,SAAA,EAAA,IAAA,CAAA,SAAA,EAHA;AAIA,MAAA,WAAA,EAAA,EAJA;AAKA,MAAA,SAAA,EAAA,EALA;AAMA,MAAA,MAAA,EAAA,EANA;AAOA,MAAA,gBAAA,EAAA,EAPA;AAQA,MAAA,OAAA,EAAA;AARA,uCASA,gBAAA,CAAA,MATA,sCAUA,gBAVA,2CAWA,IAXA,qCAYA,CAZA,sCAaA,CAbA;AAeA,GAjBA;AAkBA,EAAA,OAlBA,qBAkBA;AAAA;;AACA,IAAA,YAAA,CACA,EADA,CACA,kBADA,EACA,YAAA;AACA,MAAA,KAAA,CAAA,IAAA;AACA,KAHA,EAIA,EAJA,EAKA;AACA,IAAA,YAAA,CAAA,gBANA,EAOA,UAAA,CAAA,EAAA,IAAA,EAAA;AACA,UAAA,MAAA,GAAA,IAAA,CADA,CAEA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,MAAA;AACA,MAAA,KAAA,CAAA,MAAA,GAAA,gBAAA,CAAA,KAAA;AAEA,MAAA,KAAA,CAAA,QAAA,GAAA,MAAA,CAAA,OAAA,CAAA,MAAA;AACA,MAAA,KAAA,CAAA,SAAA,GAAA,MAAA,CAAA,QAAA,CAAA,MAAA;AACA,KAfA,EAiBA,EAjBA,EAkBA;AACA,IAAA,YAAA,CAAA,SAnBA,EAoBA,YAAA;AACA,MAAA,KAAA,CAAA,WAAA,GAAA,KAAA,CAAA,gBAAA;AACA,MAAA,KAAA,CAAA,MAAA,GAAA,gBAAA,CAAA,GAAA;AACA,MAAA,KAAA,CAAA,cAAA,GAAA,IAAA;AACA,MAAA,KAAA,CAAA,cAAA,GAAA,WAAA,CAAA,YAAA;AACA,YAAA,KAAA,CAAA,WAAA,GAAA,CAAA,EAAA;AACA,YAAA,KAAA,CAAA,WAAA;AACA,SAFA,MAEA;AACA;AACA,UAAA,YAAA,CAAA,OAAA,CAAA,YAAA,CAAA,gBAAA;AACA,UAAA,aAAA,CAAA,KAAA,CAAA,cAAA,CAAA;AACA;AACA,OARA,EAQA,IARA,CAAA;AASA,KAjCA;AAmCA,GAtDA;AAuDA,EAAA,OAAA,EAAA;AACA,IAAA,IADA,kBACA;AACA,WAAA,OAAA,GAAA,IAAA;AACA,KAHA;AAIA,IAAA,KAJA,mBAIA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,KANA;AAOA,IAAA,aAPA,2BAOA;AACA,MAAA,YAAA,CAAA,OAAA,CAAA,YAAA,CAAA,iBAAA,EAAA;AACA;AACA,QAAA,QAAA,EAAA,KAAA;AAFA,OAAA;AAIA,KAZA;AAaA,IAAA,MAbA,oBAaA;AACA,WAAA,MAAA,GAAA,gBAAA,CAAA,MAAA;AACA;AAfA,GAvDA;AAwEA,EAAA,aAxEA,2BAwEA,CAAA;AAxEA,CAAA","sourcesContent":["<!-- 点名组件实现： 点名没有独立的组件来实现，我们提供了一套事件驱动的点名系统 -->\n\n<template>\n  <div v-show=\"visible\" id=\"roll-call-dialog\" class=\"teacher\">\n    <div v-show=\"status === statusMap.before\" class=\"before-roll-call\">\n      <p>\n        请设置学生需要在\n        <input v-model=\"rollCallDuration\" type=\"number\" />\n        秒内响应\n      </p>\n      <div @click=\"startRollCall\" class=\"btn start-btn\">发起点名</div>\n    </div>\n\n    <div v-show=\"status === statusMap.ing\" class=\"roll-call-ing\">学生正在陆续答到中，{{ resultTimer }}秒后可查看点名结果，请稍后</div>\n\n    <div v-show=\"status === statusMap.after\" class=\"after-roll-call\">\n      <p class=\"result\">答到情况：答到{{ ackCount }}人，未答到{{ nackCount }}人</p>\n      <div class=\"btn\" @click=\"reCall\">再次点名</div>\n    </div>\n\n    <div class=\"btn-close\" @click=\"close\">X</div>\n  </div>\n</template>\n\n<script>\nimport language from \"../../language/main\";\n\nconst auth = BJY.auth;\nconst eventEmitter = BJY.eventEmitter;\n\nconst ROLL_CALL_STATUS = {\n    before: 0,\n    ing: 1,\n    after: 2\n}\n\nexport default {\n  data() {\n    return {\n      language: language,\n      status: 0,\n      isTeacher: auth.isTeacher(),\n      resultTimer: 60,\n      nextTimer: 60,\n      result: \"\",\n      rollCallDuration: 60,\n      visible: false,\n      status: ROLL_CALL_STATUS.before,\n      statusMap: ROLL_CALL_STATUS,\n      resultInterval: null,\n      ackCount: 0, // 答到人数\n      nackCount: 0, // 未答到人数\n    };\n  },\n  created() {\n    eventEmitter\n      .on(\"toggle_roll_call\", () => {\n        this.show();\n      })\n      .on(\n        // 点名结果\n        eventEmitter.ROLL_CALL_RESULT,\n        (e, data) => {\n          var result = data;\n        //  点名结果 \n          console.log(result);\n          this.status = ROLL_CALL_STATUS.after\n\n          this.ackCount = result.ackList.length\n          this.nackCount = result.nackList.length\n        }\n      )\n      .on(\n        // 点名开始\n        eventEmitter.ROLL_CALL,\n        () => {\n            this.resultTimer = this.rollCallDuration\n            this.status = ROLL_CALL_STATUS.ing\n            this.resultInterval = null\n            this.resultInterval = setInterval(() => {\n                if (this.resultTimer > 0) {\n                    --this.resultTimer;\n                } else {\n                    // 时间到了需要老师端主动触发结束\n                    eventEmitter.trigger(eventEmitter.ROLL_CALL_FINISH);\n                    clearInterval(this.resultInterval)\n                }\n            }, 1000);\n        }\n      );\n  },\n  methods: {\n    show() {\n      this.visible = true;\n    },\n    close() {\n      this.visible = false;\n    },\n    startRollCall() {\n      eventEmitter.trigger(eventEmitter.ROLL_CALL_TRIGGER, {\n        // 倒计时 秒\n        duration: this.rollCallDuration,\n      });\n    },\n    reCall() {\n        this.status = ROLL_CALL_STATUS.before\n    }\n  },\n  beforeDestroy() {},\n};\n</script>\n\n<style lang=\"scss\" scoped>\n#roll-call-dialog {\n  background: #fff;\n  padding: 24px;\n  font-size: 14px;\n\n  & > div {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .btn-close {\n    position: absolute;\n    top: 10px;\n    right: 10px;\n    cursor: pointer;\n  }\n\n  .before-roll-call {\n  }\n\n  .roll-call-ing {\n  }\n\n  .after-roll-call {\n  }\n\n  .btn {\n    margin: 20px auto;\n    background: #1795ff;\n    height: 40px;\n    line-height: 40px;\n    padding: 0 20px;\n    cursor: pointer;\n    color: #fff;\n  }\n}\n</style>\n"],"sourceRoot":"src/components/ModalPanel"}]}