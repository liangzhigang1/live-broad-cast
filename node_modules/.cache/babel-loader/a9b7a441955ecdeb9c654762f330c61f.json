{"remainingRequest":"/Users/liangzg/zixue/live-broad-cast/node_modules/babel-loader/lib/index.js!/Users/liangzg/zixue/live-broad-cast/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liangzg/zixue/live-broad-cast/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzg/zixue/live-broad-cast/src/components/FunctionPanel/ShareScreenMenu.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzg/zixue/live-broad-cast/src/components/FunctionPanel/ShareScreenMenu.vue","mtime":1611227050000},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/cache-loader/dist/cjs.js","mtime":1584009001591},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/babel-loader/lib/index.js","mtime":1615566678361},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/cache-loader/dist/cjs.js","mtime":1584009001591},{"path":"/Users/liangzg/zixue/live-broad-cast/node_modules/vue-loader/lib/index.js","mtime":1615566687412}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IGxhbmd1YWdlIGZyb20gJy4uLy4uL2xhbmd1YWdlL21haW4nOwp2YXIgYXV0aCA9IEJKWS5hdXRoOwp2YXIgc3RvcmUgPSBCSlkuc3RvcmU7CnZhciBldmVudEVtaXR0ZXIgPSBCSlkuZXZlbnRFbWl0dGVyOwp2YXIgY29uZmlnID0gQkpZLmNvbmZpZzsKCmF1dGguaXNDbGFzc1N0YXJ0ZWQgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHN0b3JlLmdldCgnY2xhc3Muc3RhcnRlZCcpOwp9OwoKYXV0aC5jYW5TaGFyZVNjcmVlbiA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gc3RvcmUuZ2V0KCdjbGFzcy5tZWRpYVR5cGUnKSAhPT0gY29uZmlnLk1FRElBX1RZUEVfQVVESU8gJiYgKGF1dGguaW5DbGllbnQoKSB8fCBhdXRoLmlzV2ViUlRDKCkpOwp9OwoKYXV0aC5pbkNsaWVudCA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gdHlwZW9mIHdpbmRvdy5jZWZRdWVyeSAhPT0gJ3VuZGVmaW5lZCc7Cn07CgphdXRoLmNhblNwZWFrID0gZnVuY3Rpb24gKCkgewogIHJldHVybiBhdXRoLmlzVGVhY2hlcigpIHx8IHN0b3JlLmdldCgnY2xhc3Muc3BlYWtTdGF0ZScpICE9PSBjb25maWcuU1BFQUtfU1RBVEVfTElNSVQ7Cn07Ci8qKgogKiDmmK/lkKblj6/ku6XnqIvluo/liIbkuqsKICoKICogQHJldHVybiB7Ym9vbGVhbn0KICovCgoKYXV0aC5jYW5Qcm9ncmFtU2hhcmVEZXNrdG9wID0gZnVuY3Rpb24gKCkgewogIHJldHVybiBhdXRoLmluQ2xpZW50KCkgJiYgc3RvcmUuZ2V0KCdjZWZWZXJzaW9uJykgPj0gJzYuMy4wJzsKfTsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7fSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2FuU3BlYWs6IGZhbHNlLAogICAgICBjYW5TaGFyZVNjcmVlbjogYXV0aC5jYW5TaGFyZVNjcmVlbigpCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHt9LAogIHdhdGNoOiB7fSwKICBtZXRob2RzOiB7CiAgICBjaGVja0NvbmRpdGlvbjogZnVuY3Rpb24gY2hlY2tDb25kaXRpb24oKSB7CiAgICAgIGlmICghYXV0aC5pc0NsYXNzU3RhcnRlZCgpIHx8ICFhdXRoLmNhblNoYXJlU2NyZWVuKCkpIHsKICAgICAgICB0aGlzLiRUb2FzdChsYW5ndWFnZS5USVBfQ0xBU1NfTk9UX1NUQVJUKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICghYXV0aC5jYW5TcGVhaygpKSB7CiAgICAgICAgdGhpcy4kVG9hc3QobGFuZ3VhZ2UuVElQX1NQRUFLX0xJTUlUKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdmFyIGVsZW1lbnQgPSAkKCcuYmp5LXNjcmVlbi1zaGFyZScpOyAvLyDlj6rmnIl3ZWJydGPor77nqIvnsbvlnovmlK/mjIHnvZHpobXlsY/luZXliIbkuqsKCiAgICBlbGVtZW50LnRleHQobGFuZ3VhZ2UuQlVUVE9OX1NDUkVFTl9TVEFSVCk7CgogICAgaWYgKGF1dGguaXNXZWJSVEMoKSkgewogICAgICB2YXIgaXNTY3JlZW5TaGFyaW5nID0gZmFsc2U7CiAgICAgIGV2ZW50RW1pdHRlci5vbihldmVudEVtaXR0ZXIuQVNTSVNUX01FRElBX1BVQkxJU0gsIGZ1bmN0aW9uIChldmVudCwgZGF0YSkgewogICAgICAgIGlmIChCSlkuaXMubWVkaWFNYWluU2NyZWVuU2hhcmUoZGF0YS5tZWRpYUlkKSkgewogICAgICAgICAgaWYgKGRhdGEudmlkZW9PbikgewogICAgICAgICAgICBpc1NjcmVlblNoYXJpbmcgPSB0cnVlOwogICAgICAgICAgICBlbGVtZW50LnRleHQobGFuZ3VhZ2UuQlVUVE9OX1NDUkVFTl9TVE9QKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlzU2NyZWVuU2hhcmluZyA9IGZhbHNlOwogICAgICAgICAgICBlbGVtZW50LnRleHQobGFuZ3VhZ2UuQlVUVE9OX1NDUkVFTl9TVEFSVCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgICAgZWxlbWVudC5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKGlzU2NyZWVuU2hhcmluZykgewogICAgICAgICAgZXZlbnRFbWl0dGVyLnRyaWdnZXIoZXZlbnRFbWl0dGVyLlNDUkVFTl9TSEFSRV9TVE9QX1RSSUdHRVIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoIWF1dGguY2FuU3BlYWsoKSkgewogICAgICAgICAgICBfdGhpcy4kVG9hc3QoJ+WPkeiogOivt+WFiOS4vuaJiycpOwoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzLmNoZWNrQ29uZGl0aW9uKCkgJiYgQkpZLlNjcmVlblNoYXJlRXh0ZW5zaW9uV2VicnRjLnN0YXJ0KGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgIF90aGlzLiRUb2FzdChkYXRhLm1zZyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCiAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24gYmVmb3JlRGVzdHJveSgpIHt9Cn07"},{"version":3,"sources":["ShareScreenMenu.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div v-show=\"canShareScreen\" id=\"menu-share-screen\">\n      <i class=\"icon icon-share\"></i>\n      <span class=\"bjy-screen-share\"></span>\n    </div>\n</template>\n\n<script>\nimport language from '../../language/main'\n\nlet auth = BJY.auth\nlet store = BJY.store\nlet eventEmitter = BJY.eventEmitter\nlet config = BJY.config\n\nauth.isClassStarted = function () {\n  return store.get('class.started')\n}\n\nauth.canShareScreen = function () {\n  return store.get('class.mediaType') !== config.MEDIA_TYPE_AUDIO &&\n            (auth.inClient() || auth.isWebRTC())\n}\n\nauth.inClient = function () {\n  return typeof window.cefQuery !== 'undefined'\n}\n\nauth.canSpeak = function () {\n  return auth.isTeacher() || (store.get('class.speakState') !== config.SPEAK_STATE_LIMIT)\n}\n\n/**\n * 是否可以程序分享\n *\n * @return {boolean}\n */\nauth.canProgramShareDesktop = function () {\n  return auth.inClient() && store.get('cefVersion') >= '6.3.0'\n}\n\nexport default {\n  components: {},\n  data () {\n    return {\n      canSpeak: false,\n      canShareScreen: auth.canShareScreen()\n    }\n  },\n  computed: {},\n  watch: {},\n  methods: {\n    checkCondition () {\n      if (!auth.isClassStarted() || !auth.canShareScreen()) {\n        this.$Toast(language.TIP_CLASS_NOT_START)\n        return false\n      }\n\n      if (!auth.canSpeak()) {\n        this.$Toast(language.TIP_SPEAK_LIMIT)\n        return false\n      }\n\n      return true\n    }\n  },\n  mounted () {\n    let element = $('.bjy-screen-share')\n    // 只有webrtc课程类型支持网页屏幕分享\n    element.text(language.BUTTON_SCREEN_START)\n    if (auth.isWebRTC()) {\n      var isScreenSharing = false\n\n      eventEmitter.on(\n        eventEmitter.ASSIST_MEDIA_PUBLISH,\n        (event, data) => {\n          if (BJY.is.mediaMainScreenShare(data.mediaId)) {\n            if (data.videoOn) {\n              isScreenSharing = true\n              element.text(language.BUTTON_SCREEN_STOP)\n            } else {\n              isScreenSharing = false\n              element.text(language.BUTTON_SCREEN_START)\n            }\n          }\n        }\n      )\n\n      element.click(() => {\n        if (isScreenSharing) {\n          eventEmitter.trigger(\n            eventEmitter.SCREEN_SHARE_STOP_TRIGGER\n          )\n        } else {\n          if (!auth.canSpeak()) {\n            this.$Toast('发言请先举手')\n            return\n          }\n          this.checkCondition() && BJY.ScreenShareExtensionWebrtc.start((data) => {\n            this.$Toast(data.msg)\n          })\n        }\n      })\n    }\n  },\n  beforeDestroy () {}\n}\n</script>\n\n<style lang='scss' scoped>\n//@import url(); 引入公共css类\n\n</style>\n"],"sourceRoot":"src/components/FunctionPanel"}]}